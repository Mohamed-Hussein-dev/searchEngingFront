<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <title>PharmaSearch</title>
   <style>
      /* Add image styles */
      .result-image {
          width: 100%;
          max-width: 300px;
          height: 200px;
          object-fit: cover;
          border-radius: 8px;
          margin-bottom: 1rem;
      }

      /* Rest of existing CSS remains the same */
      :root {
         --primary: #1a73e8;
         --bg: #ffffff;
         --text: #202124;
         --border: #dfe1e5;
         --secondary-text: #5f6368;
         --radius: 24px;
      }

      * {
         box-sizing: border-box;
         margin: 0;
         padding: 0;
      }

      body {
         font-family: 'Google Sans', Arial, sans-serif;
         background: var(--bg);
         color: var(--text);
         min-height: 100vh;
      }

      .container {
         max-width: 700px;
         margin: 0 auto;
         padding: 20px 15px;
      }

      .logo {
         text-align: center;
         margin: 100px 0 40px;
         font-size: 3.5rem;
         color: var(--primary);
         font-weight: 500;
         letter-spacing: -2px;
      }

      .search-box {
         position: relative;
         margin-bottom: 20px;
      }

      .search-form {
         display: flex;
         gap: 10px;
         border: 1px solid var(--border);
         border-radius: var(--radius);
         padding: 8px 15px;
         transition: all 0.2s;
         box-shadow: 0 1px 6px rgba(32, 33, 36, .28);
         align-items: center;
      }

      .search-form:focus-within {
         box-shadow: 0 1px 6px rgba(32, 33, 36, .4);
      }

      input {
         flex: 1;
         border: none;
         outline: none;
         font-size: 16px;
         padding: 10px;
         background: transparent;
      }

      #tolerance {
         width: 100px;
         padding: 8px;
         border-left: 1px solid var(--border);
         font-size: 14px;
      }

      button {
         background: var(--primary);
         color: white;
         border: none;
         padding: 12px 24px;
         border-radius: 20px;
         font-size: 14px;
         cursor: pointer;
         transition: all 0.2s;
      }

      button:hover {
         background: #1557b0;
         box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      .search-notes {
         color: var(--secondary-text);
         font-size: 13px;
         margin: 15px 0;
         line-height: 1.5;
      }

      .result-item {
         margin-bottom: 25px;
         max-width: 600px;
         padding: 20px;
         border: 1px solid var(--border);
         border-radius: 12px;
      }

      .result-title {
         color: var(--primary);
         text-decoration: none;
         font-size: 20px;
         margin-bottom: 4px;
         display: block;
      }

      .result-details {
         color: var(--secondary-text);
         font-size: 14px;
         line-height: 1.5;
      }

      .loading {
         display: none;
         text-align: center;
         margin: 40px 0;
         color: var(--secondary-text);
      }

      .no-results {
         text-align: center;
         color: var(--secondary-text);
         padding: 40px 0;
      }

      @media (max-width: 600px) {
         .logo {
            margin: 60px 0 30px;
            font-size: 2.5rem;
         }

         .search-form {
            flex-wrap: wrap;
            padding: 8px;
         }

         #tolerance {
            border-left: none;
            width: auto;
         }
      }
   </style>
</head>

<body>
   <div class="container">
      <div class="logo">Drug Search</div>

      <div class="search-box">
         <form class="search-form" onsubmit="search(); return false;">
            <input type="text" id="name" placeholder="Search medications..." autofocus>
            <input type="number" id="tolerance" placeholder="Tolerance" min="1" max="10">
            <button type="submit">Search</button>
         </form>
         <div class="search-notes">
            â€¢ Search tips: Enter at least 3 characters<br>
            â€¢ Tolerance = allowed typos (default: 50% of name length)<br>
            â€¢ Database contains 10â€¯000 entries - not found? Try increasing tolerance
         </div>
      </div>

      <div class="loading" id="loading">Searching...</div>
      <div id="results"></div>
   </div>

   <script>
      async function search() {
         const name = document.getElementById('name').value.trim();
         const tolerance = document.getElementById('tolerance').value.trim();
         const resultsDiv = document.getElementById('results');
         const loadingDiv = document.getElementById('loading');

         if (!name) return;

         resultsDiv.innerHTML = '';
         loadingDiv.style.display = 'block';

         try {
            const calculatedTolerance = tolerance || 10;
            const response = await fetch(
               `https://search-engine-api.runasp.net/api/SearchEngine/search?name=${encodeURIComponent(name)}&tolerance=${calculatedTolerance}`
            );

            const data = await response.json();

            loadingDiv.style.display = 'none';

            if (!Array.isArray(data) || data.length === 0) {
               resultsDiv.innerHTML = `
            <div class="no-results">
              No results found for "${name}"
              <div style="margin-top:10px;font-size:0.9em">
                Try increasing tolerance value
              </div>
            </div>`;
               return;
            }

            resultsDiv.innerHTML = data.map(item => `
          <div class="result-item">
            <img class="result-image" src="${item.imageURL || 'https://via.placeholder.com/300x200?text=No+Image+Available'}" alt="${item.englishName}">
            <div class="result-title">${item.englishName}</div>
            <div class="result-details">
              <div>ðŸ’° Price: ${item.price} EGP</div>
              <div>ðŸ§ª Active ingredient: ${item.activeIngredient}</div>
              <div>ðŸ“‹ Description: ${item.description || 'N/A'}</div>
              <div>ðŸ“Š Barcode: ${item.barCode}</div>
            </div>
          </div>
        `).join('');

         } catch (error) {
            console.error('Search error:', error);
            loadingDiv.style.display = 'none';
            resultsDiv.innerHTML = `
          <div class="no-results">
            Error fetching results. Please try again later.
          </div>`;
         }
      }

      // Instant search with debounce
      let timeout;
      document.getElementById('name').addEventListener('input', (e) => {
         clearTimeout(timeout);
         timeout = setTimeout(() => {
            if (e.target.value.trim().length >= 3) search();
         }, 300);
      });
   </script>
</body>
</html>
